import { Card } from '@/components/Card'
import { SimpleLayout } from '@/components/SimpleLayout'
import { getAllArticles } from '@/lib/articles'
import { formatDate } from '@/lib/formatDate'

function Article({ article }) {
  // Get the current date to compare with the article's date
  const currentDate = new Date()
  const articleDate = new Date(article.date)

  // Check if the article date is in the future
  const isComingSoon = articleDate > currentDate
  return (
    <article className="md:grid md:grid-cols-4 md:items-baseline">
      <Card className="md:col-span-3">
        <Card.Title href={`/articles/${article.slug}`}>
          {article.title}
        </Card.Title>
        <Card.Eyebrow
          as="time"
          dateTime={article.date}
          className="md:hidden"
          decorate
        >
          {formatDate(article.date)}
        </Card.Eyebrow>
        <Card.Description>{article.description}</Card.Description>
        <Card.Cta>{isComingSoon ? 'Coming soon' : 'Read article'}</Card.Cta>
        {/* <Card.Cta>Read article</Card.Cta> */}
      </Card>
      <Card.Eyebrow
        as="time"
        dateTime={article.date}
        className="mt-1 hidden md:block"
      >
        {formatDate(article.date)}
      </Card.Eyebrow>
    </article>
  )
}

export const metadata = {
  title: 'Articles',
  description:
    'A documentation of my learning journey and insights gained from years at the intersection of power systems and data science.',
}

export default async function ArticlesIndex() {
  let articles = await getAllArticles()

  return (
    <SimpleLayout
      title="thought experiments and takeaways."
      intro="A documentation of my learning journey and insights gained from years at the intersection of power systems and data science. Here, I share my evolving understanding of topics ranging from grid complexities and data-driven analyses to broader issues in energy, economics, policy, and governance. Driven by curiosity, this space captures surprising challenges, technical perspectives, and the role of data in uncovering the grid's characteristics."
    >
      <div className="md:border-l md:border-zinc-100 md:pl-6 md:dark:border-zinc-700/40">
        <div className="flex max-w-3xl flex-col space-y-16">
          {articles.map((article) => (
            <Article key={article.slug} article={article} />
          ))}
        </div>
      </div>
    </SimpleLayout>
  )
}
